<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel | Fallacy Spotter - VideoBate</title>
  <meta name="description" content="Admin dashboard for managing users, questions, and content.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öôÔ∏è</text></svg>">
  <style>
    :root {
      --bg-dark: #0f0f14;
      --bg-card: #1a1a24;
      --bg-input: #252535;
      --text-primary: #ffffff;
      --text-secondary: #a0a0b0;
      --accent-red: #ef4444;
      --accent-gold: #ffd700;
      --accent-cyan: #00d4ff;
      --accent-green: #22c55e;
      --accent-purple: #8b5cf6;
      --accent-orange: #f97316;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }
    
    /* Layout */
    .admin-layout {
      display: flex;
      min-height: 100vh;
    }
    
    /* Sidebar */
    .sidebar {
      width: 260px;
      background: var(--bg-card);
      border-right: 1px solid rgba(255,255,255,0.05);
      padding: 20px 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
    }
    .sidebar-header {
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      margin-bottom: 20px;
    }
    .sidebar-logo {
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--accent-red);
      text-decoration: none;
      display: block;
      margin-bottom: 5px;
    }
    .sidebar-logo span { color: var(--text-primary); }
    .sidebar-subtitle {
      color: var(--accent-gold);
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    .sidebar-nav {
      list-style: none;
    }
    .sidebar-nav li a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s;
      border-left: 3px solid transparent;
    }
    .sidebar-nav li a:hover {
      background: rgba(255,255,255,0.03);
      color: var(--text-primary);
    }
    .sidebar-nav li a.active {
      background: rgba(139,92,246,0.1);
      color: var(--accent-purple);
      border-left-color: var(--accent-purple);
    }
    .sidebar-nav li a .icon {
      font-size: 1.2rem;
    }
    
    .sidebar-section {
      padding: 15px 20px 10px;
      color: var(--text-secondary);
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .sidebar-footer {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 15px 20px;
      border-top: 1px solid rgba(255,255,255,0.05);
      background: var(--bg-card);
    }
    .sidebar-user {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .sidebar-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.85rem;
    }
    .sidebar-user-info {
      flex: 1;
    }
    .sidebar-user-name {
      font-weight: 600;
      font-size: 0.9rem;
    }
    .sidebar-user-role {
      color: var(--accent-red);
      font-size: 0.75rem;
    }
    
    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: 30px;
    }
    
    /* Top Bar */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }
    .page-title {
      font-size: 1.8rem;
      font-weight: 700;
    }
    .top-actions {
      display: flex;
      gap: 12px;
    }
    
    /* Cards */
    .card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 25px;
      border: 1px solid rgba(255,255,255,0.05);
      margin-bottom: 25px;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .card-title {
      font-size: 1.2rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 25px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .stat-card .label {
      color: var(--text-secondary);
      font-size: 0.9rem;
      margin-bottom: 8px;
    }
    .stat-card .value {
      font-size: 2.2rem;
      font-weight: 800;
    }
    .stat-card .value.purple { color: var(--accent-purple); }
    .stat-card .value.green { color: var(--accent-green); }
    .stat-card .value.gold { color: var(--accent-gold); }
    .stat-card .value.cyan { color: var(--accent-cyan); }
    .stat-card .change {
      font-size: 0.85rem;
      margin-top: 8px;
    }
    .stat-card .change.up { color: var(--accent-green); }
    .stat-card .change.down { color: var(--accent-red); }
    
    /* Table */
    .table-container {
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 14px 16px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    th {
      color: var(--text-secondary);
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    tr:hover {
      background: rgba(255,255,255,0.02);
    }
    .user-cell {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .user-avatar-sm {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
    }
    .role-badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .role-badge.admin {
      background: rgba(239,68,68,0.2);
      color: var(--accent-red);
    }
    .role-badge.user {
      background: rgba(139,92,246,0.2);
      color: var(--accent-purple);
    }
    
    /* Buttons */
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      text-decoration: none;
    }
    .btn-primary {
      background: var(--accent-purple);
      color: white;
    }
    .btn-primary:hover {
      background: #7c3aed;
    }
    .btn-secondary {
      background: var(--bg-input);
      color: var(--text-primary);
    }
    .btn-secondary:hover {
      background: #333;
    }
    .btn-danger {
      background: rgba(239,68,68,0.2);
      color: var(--accent-red);
    }
    .btn-danger:hover {
      background: var(--accent-red);
      color: white;
    }
    .btn-sm {
      padding: 6px 12px;
      font-size: 0.8rem;
    }
    
    /* Action Buttons in Table */
    .action-btns {
      display: flex;
      gap: 8px;
    }
    .action-btn {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .action-btn.edit {
      background: rgba(0,212,255,0.2);
      color: var(--accent-cyan);
    }
    .action-btn.edit:hover {
      background: var(--accent-cyan);
      color: white;
    }
    .action-btn.delete {
      background: rgba(239,68,68,0.2);
      color: var(--accent-red);
    }
    .action-btn.delete:hover {
      background: var(--accent-red);
      color: white;
    }
    
    /* Tabs */
    .tabs {
      display: flex;
      gap: 5px;
      background: var(--bg-dark);
      padding: 5px;
      border-radius: 10px;
      margin-bottom: 25px;
    }
    .tab {
      padding: 10px 20px;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s;
    }
    .tab.active {
      background: var(--accent-purple);
      color: white;
    }
    .tab:hover:not(.active) {
      color: var(--text-primary);
    }
    
    /* Tab Content */
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    
    /* Form */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 12px 14px;
      background: var(--bg-input);
      border: 2px solid transparent;
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 0.95rem;
      transition: all 0.3s;
    }
    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--accent-purple);
    }
    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }
    .form-select {
      cursor: pointer;
    }
    
    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal-overlay.show {
      display: flex;
    }
    .modal {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 30px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }
    .modal-title {
      font-size: 1.3rem;
      font-weight: 700;
    }
    .modal-close {
      background: none;
      border: none;
      color: var(--text-secondary);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .modal-close:hover {
      color: var(--accent-red);
    }
    .modal-footer {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    
    /* Search & Filter */
    .search-bar {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }
    .search-input {
      flex: 1;
      padding: 12px 16px;
      background: var(--bg-input);
      border: 2px solid transparent;
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 0.95rem;
    }
    .search-input:focus {
      outline: none;
      border-color: var(--accent-purple);
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
    }
    .empty-state .icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }
    .empty-state h3 {
      margin-bottom: 10px;
      color: var(--text-primary);
    }
    
    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar {
        transform: translateX(-100%);
        z-index: 1000;
      }
      .sidebar.open {
        transform: translateX(0);
      }
      .main-content {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>

  <div class="admin-layout">
    
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">üé¨ Video<span>Bate</span></a>
        <div class="sidebar-subtitle">‚öôÔ∏è Admin Panel</div>
      </div>
      
      <nav>
        <ul class="sidebar-nav">
          <li><a href="#" class="active" data-tab="dashboard"><span class="icon">üìä</span> Dashboard</a></li>
          <li><a href="#" data-tab="users"><span class="icon">üë•</span> Users</a></li>
          <li><a href="#" data-tab="questions"><span class="icon">‚ùì</span> Questions</a></li>
          <li><a href="#" data-tab="fallacies"><span class="icon">üìö</span> Fallacies</a></li>
          <li><a href="#" data-tab="reports"><span class="icon">üìà</span> Reports</a></li>
        </ul>
        
        <div class="sidebar-section">Quick Links</div>
        <ul class="sidebar-nav">
          <li><a href="profile.html"><span class="icon">üë§</span> My Profile</a></li>
          <li><a href="quiz.html"><span class="icon">üéÆ</span> Play Quiz</a></li>
          <li><a href="fallacies.html"><span class="icon">üìñ</span> View Site</a></li>
        </ul>
      </nav>
      
      <div class="sidebar-footer">
        <div class="sidebar-user">
          <div class="sidebar-avatar" id="sidebarAvatar">?</div>
          <div class="sidebar-user-info">
            <div class="sidebar-user-name" id="sidebarName">Admin</div>
            <div class="sidebar-user-role">Administrator</div>
          </div>
        </div>
      </div>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      
      <!-- DASHBOARD TAB -->
      <div class="tab-content active" id="dashboardTab">
        <div class="top-bar">
          <h1 class="page-title">üìä Dashboard</h1>
          <div class="top-actions">
            <button class="btn btn-secondary" onclick="location.reload()">üîÑ Refresh</button>
          </div>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="label">Total Users</div>
            <div class="value purple" id="totalUsers">0</div>
            <div class="change up">‚Üë Active community</div>
          </div>
          <div class="stat-card">
            <div class="label">Total Questions</div>
            <div class="value cyan" id="totalQuestions">25</div>
            <div class="change">In quiz database</div>
          </div>
          <div class="stat-card">
            <div class="label">Fallacy Types</div>
            <div class="value gold" id="totalFallacies">48</div>
            <div class="change">Documented</div>
          </div>
          <div class="stat-card">
            <div class="label">Games Played</div>
            <div class="value green" id="totalGames">0</div>
            <div class="change">All time</div>
          </div>
        </div>
        
        <!-- Recent Users -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">üë• Recent Users</h3>
            <button class="btn btn-sm btn-secondary" onclick="switchTab('users')">View All ‚Üí</button>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>User</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Score</th>
                  <th>Joined</th>
                </tr>
              </thead>
              <tbody id="recentUsersTable">
                <!-- Populated by JS -->
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">üèÜ Top Players</h3>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>User</th>
                  <th>Score</th>
                  <th>Accuracy</th>
                  <th>Games</th>
                </tr>
              </thead>
              <tbody id="topPlayersTable">
                <!-- Populated by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- USERS TAB -->
      <div class="tab-content" id="usersTab">
        <div class="top-bar">
          <h1 class="page-title">üë• User Management</h1>
          <div class="top-actions">
            <button class="btn btn-primary" onclick="openModal('addUserModal')">+ Add User</button>
          </div>
        </div>
        
        <div class="card">
          <div class="search-bar">
            <input type="text" class="search-input" id="userSearch" placeholder="Search users by name, email, or username..." oninput="filterUsers()">
            <select class="form-select" style="width: auto;" id="roleFilter" onchange="filterUsers()">
              <option value="">All Roles</option>
              <option value="admin">Admin</option>
              <option value="user">User</option>
            </select>
          </div>
          
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>User</th>
                  <th>Email</th>
                  <th>Username</th>
                  <th>Role</th>
                  <th>Score</th>
                  <th>Games</th>
                  <th>Joined</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="usersTable">
                <!-- Populated by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- QUESTIONS TAB -->
      <div class="tab-content" id="questionsTab">
        <div class="top-bar">
          <h1 class="page-title">‚ùì Question Bank</h1>
          <div class="top-actions">
            <button class="btn btn-primary" onclick="openModal('addQuestionModal')">+ Add Question</button>
          </div>
        </div>
        
        <div class="card">
          <div class="search-bar">
            <input type="text" class="search-input" id="questionSearch" placeholder="Search questions..." oninput="filterQuestions()">
            <select class="form-select" style="width: auto;" id="difficultyFilter" onchange="filterQuestions()">
              <option value="">All Difficulties</option>
              <option value="easy">Easy</option>
              <option value="medium">Medium</option>
              <option value="hard">Hard</option>
            </select>
          </div>
          
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Scenario (Preview)</th>
                  <th>Answer</th>
                  <th>Difficulty</th>
                  <th>Points</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="questionsTable">
                <!-- Populated by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- FALLACIES TAB -->
      <div class="tab-content" id="fallaciesTab">
        <div class="top-bar">
          <h1 class="page-title">üìö Fallacy Database</h1>
          <div class="top-actions">
            <button class="btn btn-primary" onclick="openModal('addFallacyModal')">+ Add Fallacy</button>
            <a href="fallacies.html" class="btn btn-secondary" target="_blank">View Library ‚Üí</a>
          </div>
        </div>
        
        <div class="card">
          <p style="color: var(--text-secondary); margin-bottom: 20px;">
            The fallacy database is currently stored in the HTML file. To add or edit fallacies, modify the <code>fallacies.html</code> file directly.
            In a production system, this would be stored in a database.
          </p>
          
          <div class="stats-grid" style="margin-bottom: 0;">
            <div class="stat-card">
              <div class="label">Total Fallacies</div>
              <div class="value gold">48</div>
            </div>
            <div class="stat-card">
              <div class="label">Categories</div>
              <div class="value purple">8</div>
            </div>
            <div class="stat-card">
              <div class="label">With ASCII Art</div>
              <div class="value cyan">48</div>
            </div>
          </div>
        </div>
        
        <!-- Categories List -->
        <div class="card">
          <h3 class="card-title" style="margin-bottom: 20px;">üìÇ Categories</h3>
          <table>
            <thead>
              <tr>
                <th>Icon</th>
                <th>Category</th>
                <th>Fallacy Count</th>
                <th>Color</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>üë§</td><td>Attack the Person</td><td>6</td><td><span style="color: #ef4444;">Red</span></td></tr>
              <tr><td>üêü</td><td>Misdirection</td><td>6</td><td><span style="color: #f97316;">Orange</span></td></tr>
              <tr><td>üéì</td><td>False Authority</td><td>6</td><td><span style="color: #8b5cf6;">Purple</span></td></tr>
              <tr><td>üß†</td><td>Logic Errors</td><td>6</td><td><span style="color: #00d4ff;">Cyan</span></td></tr>
              <tr><td>üé≠</td><td>Manipulation</td><td>6</td><td><span style="color: #ec4899;">Pink</span></td></tr>
              <tr><td>üó≥Ô∏è</td><td>Political Tactics</td><td>6</td><td><span style="color: #22c55e;">Green</span></td></tr>
              <tr><td>‚öîÔ∏è</td><td>Advanced Debate</td><td>6</td><td><span style="color: #fff;">White</span></td></tr>
              <tr><td>‚ö°</td><td>Causation Errors</td><td>6</td><td><span style="color: #f97316;">Orange</span></td></tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- REPORTS TAB -->
      <div class="tab-content" id="reportsTab">
        <div class="top-bar">
          <h1 class="page-title">üìà Reports & Analytics</h1>
          <div class="top-actions">
            <button class="btn btn-secondary">üì• Export CSV</button>
          </div>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="label">Total Score (All Users)</div>
            <div class="value gold" id="reportTotalScore">0</div>
          </div>
          <div class="stat-card">
            <div class="label">Average Score</div>
            <div class="value purple" id="reportAvgScore">0</div>
          </div>
          <div class="stat-card">
            <div class="label">Total Correct Answers</div>
            <div class="value green" id="reportCorrect">0</div>
          </div>
          <div class="stat-card">
            <div class="label">Overall Accuracy</div>
            <div class="value cyan" id="reportAccuracy">0%</div>
          </div>
        </div>
        
        <div class="card">
          <h3 class="card-title" style="margin-bottom: 20px;">üìä User Performance Summary</h3>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>User</th>
                  <th>Total Score</th>
                  <th>Games</th>
                  <th>Correct</th>
                  <th>Wrong</th>
                  <th>Accuracy</th>
                  <th>Best Streak</th>
                </tr>
              </thead>
              <tbody id="reportTable">
                <!-- Populated by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
    </main>
  </div>
  
  <!-- Add User Modal -->
  <div class="modal-overlay" id="addUserModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">‚ûï Add New User</h3>
        <button class="modal-close" onclick="closeModal('addUserModal')">&times;</button>
      </div>
      <form id="addUserForm">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">First Name</label>
            <input type="text" class="form-input" name="firstName" required>
          </div>
          <div class="form-group">
            <label class="form-label">Last Name</label>
            <input type="text" class="form-input" name="lastName" required>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Username</label>
          <input type="text" class="form-input" name="username" required>
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input type="email" class="form-input" name="email" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" name="password" required minlength="8">
        </div>
        <div class="form-group">
          <label class="form-label">Role</label>
          <select class="form-select" name="role">
            <option value="user">User</option>
            <option value="admin">Admin</option>
          </select>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeModal('addUserModal')">Cancel</button>
          <button type="submit" class="btn btn-primary">Create User</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Add Question Modal -->
  <div class="modal-overlay" id="addQuestionModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">‚ûï Add New Question</h3>
        <button class="modal-close" onclick="closeModal('addQuestionModal')">&times;</button>
      </div>
      <form id="addQuestionForm">
        <div class="form-group">
          <label class="form-label">Scenario (HTML allowed)</label>
          <textarea class="form-textarea" name="scenario" required placeholder='<span class="scenario-speaker">Person:</span> "Quote here..."'></textarea>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Correct Answer (Code)</label>
            <input type="text" class="form-input" name="answer" required placeholder="e.g., STRW">
          </div>
          <div class="form-group">
            <label class="form-label">Difficulty</label>
            <select class="form-select" name="difficulty">
              <option value="easy">Easy (+10 pts)</option>
              <option value="medium">Medium (+25 pts)</option>
              <option value="hard">Hard (+50 pts)</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Wrong Options (comma-separated codes)</label>
          <input type="text" class="form-input" name="wrongOptions" required placeholder="e.g., RHER, FLSD, AUTH">
        </div>
        <div class="form-group">
          <label class="form-label">Explanation</label>
          <textarea class="form-textarea" name="explanation" required></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeModal('addQuestionModal')">Cancel</button>
          <button type="submit" class="btn btn-primary">Add Question</button>
        </div>
      </form>
    </div>
  </div>

<script>
// ========== USER SYSTEM ==========
function getUsers() {
  return JSON.parse(localStorage.getItem('fallacySpotter_users') || '[]');
}

function saveUsers(users) {
  localStorage.setItem('fallacySpotter_users', JSON.stringify(users));
}

function getCurrentUser() {
  return JSON.parse(localStorage.getItem('fallacySpotter_currentUser') || 'null');
}

// ========== AUTH CHECK ==========
const currentUser = getCurrentUser();
if (!currentUser || currentUser.role !== 'admin') {
  alert('Access denied. Admin privileges required.');
  window.location.href = 'login.html';
}

// Populate sidebar
document.getElementById('sidebarAvatar').textContent = (currentUser.firstName[0] + currentUser.lastName[0]).toUpperCase();
document.getElementById('sidebarName').textContent = currentUser.firstName + ' ' + currentUser.lastName;

// ========== TAB SWITCHING ==========
document.querySelectorAll('.sidebar-nav a[data-tab]').forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    switchTab(link.dataset.tab);
  });
});

function switchTab(tabName) {
  // Update sidebar
  document.querySelectorAll('.sidebar-nav a').forEach(a => a.classList.remove('active'));
  document.querySelector(`.sidebar-nav a[data-tab="${tabName}"]`)?.classList.add('active');
  
  // Update content
  document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
  document.getElementById(tabName + 'Tab')?.classList.add('active');
  
  // Load data for tab
  if (tabName === 'users') loadUsersTable();
  if (tabName === 'questions') loadQuestionsTable();
  if (tabName === 'reports') loadReports();
}

// ========== MODAL ==========
function openModal(id) {
  document.getElementById(id).classList.add('show');
}

function closeModal(id) {
  document.getElementById(id).classList.remove('show');
}

// ========== DASHBOARD ==========
function loadDashboard() {
  const users = getUsers();
  
  document.getElementById('totalUsers').textContent = users.length;
  
  // Calculate total games
  let totalGames = users.reduce((sum, u) => sum + u.stats.gamesPlayed, 0);
  document.getElementById('totalGames').textContent = totalGames;
  
  // Recent users table
  const recentUsers = [...users].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).slice(0, 5);
  document.getElementById('recentUsersTable').innerHTML = recentUsers.map(u => `
    <tr>
      <td>
        <div class="user-cell">
          <div class="user-avatar-sm">${(u.firstName[0] + u.lastName[0]).toUpperCase()}</div>
          ${u.firstName} ${u.lastName}
        </div>
      </td>
      <td>${u.email}</td>
      <td><span class="role-badge ${u.role}">${u.role}</span></td>
      <td>${u.stats.totalScore.toLocaleString()}</td>
      <td>${new Date(u.createdAt).toLocaleDateString()}</td>
    </tr>
  `).join('');
  
  // Top players table
  const topPlayers = [...users].sort((a, b) => b.stats.totalScore - a.stats.totalScore).slice(0, 5);
  document.getElementById('topPlayersTable').innerHTML = topPlayers.map((u, i) => {
    const total = u.stats.correctAnswers + u.stats.wrongAnswers;
    const accuracy = total > 0 ? Math.round((u.stats.correctAnswers / total) * 100) : 0;
    return `
      <tr>
        <td>${i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : i + 1}</td>
        <td>
          <div class="user-cell">
            <div class="user-avatar-sm">${(u.firstName[0] + u.lastName[0]).toUpperCase()}</div>
            ${u.firstName} ${u.lastName}
          </div>
        </td>
        <td style="color: var(--accent-gold); font-weight: 700;">${u.stats.totalScore.toLocaleString()}</td>
        <td>${accuracy}%</td>
        <td>${u.stats.gamesPlayed}</td>
      </tr>
    `;
  }).join('');
}

// ========== USERS TABLE ==========
function loadUsersTable() {
  const users = getUsers();
  renderUsersTable(users);
}

function renderUsersTable(users) {
  document.getElementById('usersTable').innerHTML = users.map(u => `
    <tr>
      <td>
        <div class="user-cell">
          <div class="user-avatar-sm">${(u.firstName[0] + u.lastName[0]).toUpperCase()}</div>
          ${u.firstName} ${u.lastName}
        </div>
      </td>
      <td>${u.email}</td>
      <td>@${u.username}</td>
      <td><span class="role-badge ${u.role}">${u.role}</span></td>
      <td>${u.stats.totalScore.toLocaleString()}</td>
      <td>${u.stats.gamesPlayed}</td>
      <td>${new Date(u.createdAt).toLocaleDateString()}</td>
      <td>
        <div class="action-btns">
          <button class="action-btn edit" onclick="editUser(${u.id})" title="Edit">‚úèÔ∏è</button>
          <button class="action-btn delete" onclick="deleteUser(${u.id})" title="Delete">üóëÔ∏è</button>
        </div>
      </td>
    </tr>
  `).join('');
}

function filterUsers() {
  const search = document.getElementById('userSearch').value.toLowerCase();
  const role = document.getElementById('roleFilter').value;
  
  let users = getUsers();
  
  if (search) {
    users = users.filter(u => 
      u.firstName.toLowerCase().includes(search) ||
      u.lastName.toLowerCase().includes(search) ||
      u.email.toLowerCase().includes(search) ||
      u.username.toLowerCase().includes(search)
    );
  }
  
  if (role) {
    users = users.filter(u => u.role === role);
  }
  
  renderUsersTable(users);
}

function deleteUser(id) {
  if (!confirm('Are you sure you want to delete this user?')) return;
  
  let users = getUsers();
  users = users.filter(u => u.id !== id);
  saveUsers(users);
  loadUsersTable();
  loadDashboard();
}

function editUser(id) {
  alert('Edit user modal - TODO: Implement full edit functionality');
}

// ========== ADD USER ==========
document.getElementById('addUserForm').addEventListener('submit', (e) => {
  e.preventDefault();
  
  const form = e.target;
  const users = getUsers();
  
  const newUser = {
    id: Date.now(),
    firstName: form.firstName.value.trim(),
    lastName: form.lastName.value.trim(),
    username: form.username.value.trim(),
    email: form.email.value.trim(),
    password: form.password.value,
    role: form.role.value,
    createdAt: new Date().toISOString(),
    stats: {
      totalScore: 0,
      gamesPlayed: 0,
      correctAnswers: 0,
      wrongAnswers: 0,
      bestStreak: 0,
      badges: []
    }
  };
  
  users.push(newUser);
  saveUsers(users);
  
  closeModal('addUserModal');
  form.reset();
  loadUsersTable();
  loadDashboard();
  alert('User created successfully!');
});

// ========== QUESTIONS ==========
// Demo questions (in production, these would be in a database)
const questions = [
  { id: 1, scenario: 'Politician attacks opponent\'s character...', answer: 'CHAR', difficulty: 'easy', points: 10 },
  { id: 2, scenario: 'Parent uses slippery slope argument...', answer: 'SLIP', difficulty: 'easy', points: 10 },
  { id: 3, scenario: 'Debater creates straw man...', answer: 'STRW', difficulty: 'easy', points: 10 },
  { id: 4, scenario: 'Ad uses appeal to authority...', answer: 'AUTH', difficulty: 'easy', points: 10 },
  { id: 5, scenario: 'Person uses whataboutism...', answer: 'WHAT', difficulty: 'easy', points: 10 },
  { id: 6, scenario: 'Marketing uses appeal to popularity...', answer: 'POPUL', difficulty: 'easy', points: 10 },
  { id: 7, scenario: 'Conspiracy theorist uses argument from ignorance...', answer: 'IGNR', difficulty: 'medium', points: 25 },
  { id: 8, scenario: 'Interviewer asks loaded question...', answer: 'LOAD', difficulty: 'medium', points: 25 },
  { id: 9, scenario: 'Pundit poisons the well...', answer: 'WELL', difficulty: 'medium', points: 25 },
  { id: 10, scenario: 'Skeptic uses anecdotal evidence...', answer: 'ANEC', difficulty: 'medium', points: 25 },
];

function loadQuestionsTable() {
  renderQuestionsTable(questions);
}

function renderQuestionsTable(qs) {
  document.getElementById('questionsTable').innerHTML = qs.map((q, i) => `
    <tr>
      <td>${i + 1}</td>
      <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${q.scenario}</td>
      <td><code style="background: rgba(0,212,255,0.2); padding: 2px 8px; border-radius: 4px;">${q.answer}</code></td>
      <td><span class="role-badge" style="background: ${q.difficulty === 'easy' ? 'rgba(34,197,94,0.2)' : q.difficulty === 'medium' ? 'rgba(255,215,0,0.2)' : 'rgba(239,68,68,0.2)'}; color: ${q.difficulty === 'easy' ? '#22c55e' : q.difficulty === 'medium' ? '#ffd700' : '#ef4444'};">${q.difficulty}</span></td>
      <td>+${q.points}</td>
      <td>
        <div class="action-btns">
          <button class="action-btn edit" title="Edit">‚úèÔ∏è</button>
          <button class="action-btn delete" title="Delete">üóëÔ∏è</button>
        </div>
      </td>
    </tr>
  `).join('');
}

function filterQuestions() {
  const search = document.getElementById('questionSearch').value.toLowerCase();
  const difficulty = document.getElementById('difficultyFilter').value;
  
  let filtered = questions;
  
  if (search) {
    filtered = filtered.filter(q => q.scenario.toLowerCase().includes(search) || q.answer.toLowerCase().includes(search));
  }
  
  if (difficulty) {
    filtered = filtered.filter(q => q.difficulty === difficulty);
  }
  
  renderQuestionsTable(filtered);
}

// ========== REPORTS ==========
function loadReports() {
  const users = getUsers();
  
  let totalScore = 0, totalCorrect = 0, totalWrong = 0;
  
  users.forEach(u => {
    totalScore += u.stats.totalScore;
    totalCorrect += u.stats.correctAnswers;
    totalWrong += u.stats.wrongAnswers;
  });
  
  const totalAnswers = totalCorrect + totalWrong;
  const accuracy = totalAnswers > 0 ? Math.round((totalCorrect / totalAnswers) * 100) : 0;
  const avgScore = users.length > 0 ? Math.round(totalScore / users.length) : 0;
  
  document.getElementById('reportTotalScore').textContent = totalScore.toLocaleString();
  document.getElementById('reportAvgScore').textContent = avgScore.toLocaleString();
  document.getElementById('reportCorrect').textContent = totalCorrect.toLocaleString();
  document.getElementById('reportAccuracy').textContent = accuracy + '%';
  
  // Report table
  document.getElementById('reportTable').innerHTML = users.map(u => {
    const total = u.stats.correctAnswers + u.stats.wrongAnswers;
    const acc = total > 0 ? Math.round((u.stats.correctAnswers / total) * 100) : 0;
    return `
      <tr>
        <td>${u.firstName} ${u.lastName}</td>
        <td style="color: var(--accent-gold);">${u.stats.totalScore.toLocaleString()}</td>
        <td>${u.stats.gamesPlayed}</td>
        <td style="color: var(--accent-green);">${u.stats.correctAnswers}</td>
        <td style="color: var(--accent-red);">${u.stats.wrongAnswers}</td>
        <td>${acc}%</td>
        <td>${u.stats.bestStreak}</td>
      </tr>
    `;
  }).join('');
}

// ========== INIT ==========
loadDashboard();
</script>

</body>
</html>
